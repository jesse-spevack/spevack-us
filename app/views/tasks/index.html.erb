<div class="max-w-2xl mx-auto p-4">
  <header class="text-center mb-8">
    <h1 class="text-2xl font-bold mb-4">ChoreTracker</h1>
    <div class="mb-4">
      <span class="text-lg"><%= @child.name %></span>
      <%= button_to "Switch Child", session_path, 
          method: :delete,
          class: "inline-block ml-4 px-4 py-1 border-2 border-black text-base font-semibold hover:bg-gray-100" %>
    </div>
    <div class="flex items-center justify-center gap-4 mb-4">
      <%= link_to "←", tasks_path(date: @date - 1), 
          class: "text-2xl px-4 py-2" %>
      <h2 class="text-xl">
        <%= @date.strftime("%A, %B %d") %>
      </h2>
      <%= link_to "→", tasks_path(date: @date + 1), 
          class: "text-2xl px-4 py-2",
          style: (@date >= Date.current ? "visibility: hidden" : "") %>
    </div>
    <% unless @is_today %>
      <div>
        <%= link_to "Today", tasks_path, 
            class: "inline-block px-6 py-2 border-2 border-black text-lg font-semibold hover:bg-gray-100" %>
      </div>
    <% end %>
  </header>
  
  <% %w[morning afternoon evening].each do |time_period| %>
    <% tasks_for_period = @tasks.select { |t| t.time_of_day == time_period && t.due_on?(@date) } %>
    <% if tasks_for_period.any? %>
      <section class="mb-8">
        <h3 class="text-lg font-semibold mb-4 capitalize"><%= time_period %></h3>
        <% tasks_for_period.each do |task| %>
          <% completion = task.task_completion_for_day(@date) %>
          <%= form_with url: completion ? task_task_completion_path(task, completion, date: @date) : task_task_completions_path(task, date: @date),
                      method: completion ? :delete : :post,
                      class: "task-row" do |f| %>
            <label class="flex items-center gap-4 p-4 border-2 border-black mb-2 cursor-pointer">
              <input type="checkbox" 
                     <%= 'checked' if completion %>
                     onchange="this.form.submit()"
                     class="w-8 h-8">
              <span class="text-xl flex-1"><%= task.name %></span>
            </label>
          <% end %>
        <% end %>
      </section>
    <% end %>
  <% end %>
</div>